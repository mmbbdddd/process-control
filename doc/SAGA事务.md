# demo
以支付订单为例
![img_6.png](img_6.png)

包含了
`init(订单已受理),
send(发送中), 
su,fail，pay_result_unknow(结果未知),` 几个状态
 

一个最简单的支付发送接口在SAGA事务下的状态是这样的。


 - 1，init
 - 2，init响应流程push事件
    - 2.1 设置状态为pay_result_unknow，如果设置失败，则结束
    - 2.2 执行payAction
    - 2.3 执行路由
    - 2.3 解析结果su/fail，如以上过程有任何异常则设置状态pay_result_unknow

 - 3，响应任务调度事件
 - 4，获取当前状态pay_result_unknow，并执行其PayQueryAction获取当前结果
 - ......

这就是一个SAGA事务的典型流程，可以看出有如下特征

    1，将长事务流程（N个状态）拆分成很多个1对1的原子状态变迁事务
    2，每个原子状态变迁事务包含了三个状态为A、B和容错保护态C
    3，多次调度执行，实现多个原子事务组成长事务流程。

优点
1，短事务、高性能
2，适合微服务架构
缺点
1，隔离性差，需要代码层面做脏读处理。（即银行常见的冻结字段方案）
 
